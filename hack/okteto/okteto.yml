
build:
  queryplan-proxy:
    context: ../../
    dockerfile: ./okteto.Dockerfile

deploy:
  - cd okteto/k8s && kustomize edit set image queryplan-proxy=${OKTETO_BUILD_QUERYPLAN_PROXY_IMAGE}
  - kubectl apply -k ./okteto/k8s

dev:
  queryplan-proxy:
    command: make okteto-dev && bash || bash
    workdir: /go/src/github.com/queryplan-ai/queryplan-proxy
    sync:
      - ./queryplan-proxy:/go/src/github.com/queryplan-ai/queryplan-proxy
